/**
 * Header component for vulnerability list with sorting controls
 */

import { HStack, Button, Text, Box, Spacer, useColorModeValue } from '@chakra-ui/react';
import { SortField } from '../../hooks/useSortedVulnerabilities';
import { ArrowUpIcon, ArrowDownIcon } from '@chakra-ui/icons';

interface VulnerabilityListHeaderProps {
  sortField: SortField;
  sortOrder: 'asc' | 'desc';
  onSort: (field: SortField) => void;
  selectedCount: number;
  onClearSelection: () => void;
  onSelectAllCurrent: () => void;
  onOpenComparison?: () => void;
  maxSelectable?: number;
}

const sortLabels: Record<SortField, string> = {
  cvss: 'CVSS Score',
  severity: 'Severity',
  published: 'Published Date',
  cve: 'CVE ID',
};

function VulnerabilityListHeader({
  sortField,
  sortOrder,
  onSort,
  selectedCount,
  onClearSelection,
  onSelectAllCurrent,
  onOpenComparison,
  maxSelectable = 4,
}: VulnerabilityListHeaderProps) {
  const containerBg = useColorModeValue('gray.50', 'gray.700');
  const textColor = useColorModeValue('gray.600', 'gray.300');

  return (
    <Box bg={containerBg} p={{ base: 3, md: 4 }} borderRadius="md" mb={{ base: 3, md: 4 }} borderWidth="1px" borderColor={useColorModeValue('gray.200', 'gray.600')}>
      <HStack spacing={4} align="center" flexWrap="wrap">
        <Text fontSize={{ base: 'sm', md: 'sm' }} fontWeight="bold" color={textColor}>
          Sort by:
        </Text>
        {(Object.keys(sortLabels) as SortField[]).map((field) => (
          <Button
            key={field}
            size="sm"
            variant={sortField === field ? 'solid' : 'ghost'}
            colorScheme={sortField === field ? 'blue' : 'gray'}
            onClick={() => onSort(field)}
            rightIcon={
              sortField === field ? (
                sortOrder === 'asc' ? <ArrowUpIcon /> : <ArrowDownIcon />
              ) : undefined
            }
          >
            {sortLabels[field]}
          </Button>
        ))}
        <Spacer />
        <HStack spacing={3} align="center">
          <Text fontSize="sm" color={textColor}>
            Selected: {selectedCount}
            {selectedCount > 0 && ` / ${maxSelectable}`}
          </Text>
          <Button
            size="sm"
            variant="ghost"
            onClick={onSelectAllCurrent}
            isDisabled={selectedCount >= maxSelectable}
          >
            Select All
          </Button>
          <Button
            size="sm"
            variant="ghost"
            onClick={onClearSelection}
            isDisabled={selectedCount === 0}
          >
            Clear
          </Button>
          <Button
            size="sm"
            colorScheme="blue"
            onClick={onOpenComparison}
            isDisabled={selectedCount < 2}
          >
            Compare ({selectedCount})
          </Button>
        </HStack>
      </HStack>
    </Box>
  );
}

export default VulnerabilityListHeader;

